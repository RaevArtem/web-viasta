# Документация проекта Web-Viasta

Данный документ описывает структуру данных и логику работы приложения Web-Viasta.

## Содержание
1. [Модели данных](#модели-данных)
2. [API эндпоинты](#api-эндпоинты)
3. [Структура хранилища данных](#структура-хранилища-данных)
4. [Административная часть (потенциальная)](#административная-часть-потенциальная)
5. [Бизнес-логика](#бизнес-логика)

## Модели данных

Все модели данных определены в файле `shared/schema.ts`. Ниже приведено описание каждой модели.

### Product (Кондиционер)

Основная модель продукта (кондиционера).

| Поле | Тип | Описание |
|------|-----|----------|
| id | number | Уникальный идентификатор |
| name | string | Название кондиционера |
| description | string | Описание кондиционера |
| price | number | Цена в рублях |
| discountPrice | number (nullable) | Цена со скидкой (если есть) |
| images | string[] | Массив URL-ов изображений |
| area | string | Площадь охлаждения (например, "до 20 м²") |
| type | string | Тип кондиционера (например, "Сплит-система") |
| brand | string | Бренд кондиционера |
| energyEfficiency | string | Класс энергоэффективности |
| noiseLevel | string | Уровень шума |
| features | string[] | Особенности и функции |
| dimensions | string | Размеры |
| weight | number | Вес в кг |
| warranty | string | Информация о гарантии |
| installationCost | number | Стоимость установки |
| availableForInstallation | boolean | Доступность для установки |
| inStock | boolean | Наличие на складе |
| popularity | number | Рейтинг популярности |
| createdAt | Date | Дата добавления в каталог |

### Service (Услуга)

Модель услуг, предоставляемых компанией.

| Поле | Тип | Описание |
|------|-----|----------|
| id | number | Уникальный идентификатор |
| name | string | Название услуги |
| description | string | Описание услуги |
| price | number | Стоимость услуги |
| duration | string | Примерная длительность оказания услуги |
| image | string | URL изображения |
| category | string | Категория услуги |

### Testimonial (Отзыв)

Модель отзывов клиентов.

| Поле | Тип | Описание |
|------|-----|----------|
| id | number | Уникальный идентификатор |
| clientName | string | Имя клиента |
| photo | string (nullable) | URL фото клиента |
| rating | number | Оценка (от 1 до 5) |
| text | string | Текст отзыва |
| date | Date | Дата отзыва |
| service | string | Услуга, о которой оставлен отзыв |

### FAQ (Часто задаваемые вопросы)

Модель для часто задаваемых вопросов.

| Поле | Тип | Описание |
|------|-----|----------|
| id | number | Уникальный идентификатор |
| question | string | Вопрос |
| answer | string | Ответ |
| category | string | Категория вопроса |

### ContactForm (Форма контакта)

Модель для форм запроса консультации.

| Поле | Тип | Описание |
|------|-----|----------|
| id | number | Уникальный идентификатор |
| name | string | Имя клиента |
| phone | string | Телефон клиента |
| email | string | Email клиента |
| message | string | Сообщение |
| contactMethod | string | Предпочтительный способ связи |
| createdAt | Date | Дата создания заявки |
| status | string | Статус заявки |

### Benefit (Преимущество)

Модель для преимуществ компании.

| Поле | Тип | Описание |
|------|-----|----------|
| id | number | Уникальный идентификатор |
| title | string | Заголовок преимущества |
| description | string | Описание преимущества |
| icon | string | Название иконки |

## API эндпоинты

В проекте определены следующие API эндпоинты:

| Метод | Путь | Описание |
|-------|------|----------|
| GET | /api/products | Получение списка всех кондиционеров |
| GET | /api/products/:id | Получение информации о конкретном кондиционере |
| GET | /api/products/filter | Фильтрация кондиционеров по параметрам |
| GET | /api/services | Получение списка услуг |
| GET | /api/testimonials | Получение отзывов клиентов |
| GET | /api/faqs | Получение часто задаваемых вопросов |
| GET | /api/benefits | Получение списка преимуществ компании |
| POST | /api/contact | Отправка формы обратной связи |

## Структура хранилища данных

В текущей реализации используется хранилище в памяти (`MemStorage`), которое инициализируется тестовыми данными при запуске приложения.

Интерфейс хранилища `IStorage` определяет следующие методы:

```typescript
export interface IStorage {
  // Продукты
  getAllProducts(): Promise<Product[]>;
  getProductById(id: number): Promise<Product | undefined>;
  getProductsByFilter(filters: ProductFilter): Promise<Product[]>;
  addProduct(product: InsertProduct): Promise<Product>;
  
  // Услуги
  getAllServices(): Promise<Service[]>;
  
  // Отзывы
  getAllTestimonials(): Promise<Testimonial[]>;
  
  // FAQ
  getAllFaqs(): Promise<Faq[]>;
  
  // Контактные формы
  submitContactForm(form: InsertContactForm): Promise<ContactForm>;
  
  // Преимущества
  getAllBenefits(): Promise<Benefit[]>;
}
```

## Административная часть (потенциальная)

Хотя в текущей реализации отсутствует административная панель, в случае миграции на Django или другой фреймворк с админ-панелью, вот какие функциональные возможности должны быть реализованы:

### Управление продуктами
- Добавление, редактирование, удаление кондиционеров
- Загрузка изображений
- Управление скидками
- Управление наличием на складе

### Управление услугами
- Добавление, редактирование, удаление услуг
- Управление категориями услуг
- Установка цен

### Управление контентом
- Редактирование текстов на страницах
- Управление преимуществами компании
- Управление FAQ

### Управление заявками
- Просмотр новых заявок на консультацию
- Изменение статуса заявок (новая, в обработке, обработана)
- Экспорт заявок в Excel/CSV

### Управление отзывами
- Модерация новых отзывов
- Публикация/отклонение отзывов
- Ответы на отзывы

### Аналитика
- Просмотр статистики посещений
- Анализ популярных товаров
- Отчеты по продажам

## Бизнес-логика

### Фильтрация продуктов

Фильтрация продуктов осуществляется по следующим параметрам:
- Площадь помещения (area)
- Тип кондиционера (type)
- Бренд (brand)
- Ценовой диапазон (priceRange)

Реализация фильтрации находится в методе `getProductsByFilter` класса `MemStorage`.

### Подсчет скидки

Если для продукта установлена скидочная цена (discountPrice), то процент скидки вычисляется по формуле:
```
discountPercentage = ((price - discountPrice) / price) * 100
```

### Форма контакта

При отправке формы контакта выполняется:
1. Валидация данных с использованием Zod
2. Сохранение заявки в хранилище данных
3. Присвоение статуса "новая" по умолчанию

### Сравнение продуктов

Функциональность сравнения продуктов позволяет:
1. Добавлять продукты в список сравнения
2. Визуально сравнивать характеристики продуктов в таблице
3. Удалять продукты из сравнения